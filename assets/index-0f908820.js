import{d as W,C as Y,k as d,s as I,L as N,c as Z,o as s,b as l,e,t as i,F as z,r as O,f as x,n as M,l as w,w as _,T as S,D as ee,a as T,m as te,O as ae,A as oe,B as re,R as ne,S as se}from"./index-fa2db9d6.js";import{_ as le}from"./EntitiesMapViewer-bc4914c1.js";import{D as V}from"./DateUtils-c1a87f7b.js";import{g as U}from"./Colors-74604422.js";import{_ as ie}from"./ChartComponent-7f59dc61.js";import{_ as de,a as ue}from"./Select-bf356678.js";import{_ as ce}from"./BfTable-1e0d91ab.js";import{p as he}from"./parcelData-63db60fa.js";import{_ as me}from"./plugin-vue_export-helper-c27b6911.js";import"./cicciotto-25d2cff1.js";import"./use-outside-click-21f3f43a.js";import"./use-text-value-05efac81.js";import"./use-tree-walker-7cc814eb.js";const fe=[{id:0,name:"S03925",type:"Trattore a ruote",last_activity:new Date("2023-07-18"),fuel:24,signal:100,coordinates:{lat:45.560286922994884,lon:10.721558966213962},hours:[{id:0,count:Math.floor(Math.random()*9),date:new Date("2023-07-18")},{id:1,count:Math.floor(Math.random()*9),date:new Date("2023-07-17")},{id:2,count:Math.floor(Math.random()*9),date:new Date("2023-07-16")},{id:3,count:Math.floor(Math.random()*9),date:new Date("2023-07-15")},{id:4,count:Math.floor(Math.random()*9),date:new Date("2023-07-14")},{id:5,count:Math.floor(Math.random()*9),date:new Date("2023-07-13")},{id:6,count:Math.floor(Math.random()*9),date:new Date("2023-07-12")}],activities:[{id:0,hours:Math.floor(Math.random()*9),date:new Date("2023-07-18"),type:"Aratura",workerName:"Mario Rossi"},{id:1,hours:Math.floor(Math.random()*9),date:new Date("2023-07-17"),type:"Raccolta",workerName:"Mario Rossi"},{id:2,hours:Math.floor(Math.random()*9),date:new Date("2023-07-16"),type:"Semina",workerName:"Mario Rossi"},{id:3,hours:Math.floor(Math.random()*9),date:new Date("2023-07-15"),type:"Aratura",workerName:"Mario Rossi"},{id:4,hours:Math.floor(Math.random()*9),date:new Date("2023-07-14"),type:"Raccolta",workerName:"Mario Rossi"},{id:5,hours:Math.floor(Math.random()*9),date:new Date("2023-07-13"),type:"Semina",workerName:"Mario Rossi"},{id:6,hours:Math.floor(Math.random()*9),date:new Date("2023-07-12"),type:"Aratura",workerName:"Mario Rossi"}]},{id:1,name:"S05321",type:"Carro trinciatore",last_activity:new Date("2023-07-14"),fuel:67,signal:90,coordinates:{lat:45.561788608518086,lon:10.719467188742241},hours:[{id:0,count:Math.floor(Math.random()*9),date:new Date("2023-07-18")},{id:1,count:Math.floor(Math.random()*9),date:new Date("2023-07-17")},{id:2,count:Math.floor(Math.random()*9),date:new Date("2023-07-16")},{id:3,count:Math.floor(Math.random()*9),date:new Date("2023-07-15")},{id:4,count:Math.floor(Math.random()*9),date:new Date("2023-07-14")},{id:5,count:Math.floor(Math.random()*9),date:new Date("2023-07-13")},{id:6,count:Math.floor(Math.random()*9),date:new Date("2023-07-12")}],activities:[{id:0,hours:Math.floor(Math.random()*9),date:new Date("2023-07-18"),type:"Aratura",workerName:"Mario Rossi"},{id:1,hours:Math.floor(Math.random()*9),date:new Date("2023-07-17"),type:"Raccolta",workerName:"Mario Rossi"},{id:2,hours:Math.floor(Math.random()*9),date:new Date("2023-07-16"),type:"Semina",workerName:"Mario Rossi"},{id:3,hours:Math.floor(Math.random()*9),date:new Date("2023-07-15"),type:"Aratura",workerName:"Mario Rossi"},{id:4,hours:Math.floor(Math.random()*9),date:new Date("2023-07-14"),type:"Raccolta",workerName:"Mario Rossi"},{id:5,hours:Math.floor(Math.random()*9),date:new Date("2023-07-13"),type:"Semina",workerName:"Mario Rossi"},{id:6,hours:Math.floor(Math.random()*9),date:new Date("2023-07-12"),type:"Aratura",workerName:"Mario Rossi"}]},{id:2,name:"S08513",type:"Motozappatrice",last_activity:new Date("2023-07-02"),fuel:45,signal:60,coordinates:{lat:45.56160296275679,lon:10.720474777327212},hours:[{id:0,count:Math.floor(Math.random()*9),date:new Date("2023-07-18")},{id:1,count:Math.floor(Math.random()*9),date:new Date("2023-07-17")},{id:2,count:Math.floor(Math.random()*9),date:new Date("2023-07-16")},{id:3,count:Math.floor(Math.random()*9),date:new Date("2023-07-15")},{id:4,count:Math.floor(Math.random()*9),date:new Date("2023-07-14")},{id:5,count:Math.floor(Math.random()*9),date:new Date("2023-07-13")},{id:6,count:Math.floor(Math.random()*9),date:new Date("2023-07-12")}],activities:[{id:0,hours:Math.floor(Math.random()*9),date:new Date("2023-07-18"),type:"Aratura",workerName:"Mario Rossi"},{id:1,hours:Math.floor(Math.random()*9),date:new Date("2023-07-17"),type:"Raccolta",workerName:"Mario Rossi"},{id:2,hours:Math.floor(Math.random()*9),date:new Date("2023-07-16"),type:"Semina",workerName:"Mario Rossi"},{id:3,hours:Math.floor(Math.random()*9),date:new Date("2023-07-15"),type:"Aratura",workerName:"Mario Rossi"},{id:4,hours:Math.floor(Math.random()*9),date:new Date("2023-07-14"),type:"Raccolta",workerName:"Mario Rossi"},{id:5,hours:Math.floor(Math.random()*9),date:new Date("2023-07-13"),type:"Semina",workerName:"Mario Rossi"},{id:6,hours:Math.floor(Math.random()*9),date:new Date("2023-07-12"),type:"Aratura",workerName:"Mario Rossi"}]},{id:3,name:"S00593",type:"Mietitrebbia",last_activity:new Date("2023-04-28"),fuel:56,signal:100,coordinates:{lat:45.559936248891546,lon:10.720922594476088},hours:[{id:0,count:Math.floor(Math.random()*9),date:new Date("2023-07-18")},{id:1,count:Math.floor(Math.random()*9),date:new Date("2023-07-17")},{id:2,count:Math.floor(Math.random()*9),date:new Date("2023-07-16")},{id:3,count:Math.floor(Math.random()*9),date:new Date("2023-07-15")},{id:4,count:Math.floor(Math.random()*9),date:new Date("2023-07-14")},{id:5,count:Math.floor(Math.random()*9),date:new Date("2023-07-13")},{id:6,count:Math.floor(Math.random()*9),date:new Date("2023-07-12")}],activities:[{id:0,hours:Math.floor(Math.random()*9),date:new Date("2023-07-18"),type:"Aratura",workerName:"Mario Rossi"},{id:1,hours:Math.floor(Math.random()*9),date:new Date("2023-07-17"),type:"Raccolta",workerName:"Mario Rossi"},{id:2,hours:Math.floor(Math.random()*9),date:new Date("2023-07-16"),type:"Semina",workerName:"Mario Rossi"},{id:3,hours:Math.floor(Math.random()*9),date:new Date("2023-07-15"),type:"Aratura",workerName:"Mario Rossi"},{id:4,hours:Math.floor(Math.random()*9),date:new Date("2023-07-14"),type:"Raccolta",workerName:"Mario Rossi"},{id:5,hours:Math.floor(Math.random()*9),date:new Date("2023-07-13"),type:"Semina",workerName:"Mario Rossi"},{id:6,hours:Math.floor(Math.random()*9),date:new Date("2023-07-12"),type:"Aratura",workerName:"Mario Rossi"}]},{id:4,name:"S03858",type:"Vendemmiatrice semovente",last_activity:new Date("2023-02-14"),fuel:78,signal:20,coordinates:{lat:45.55896672672015,lon:10.721040441094033},hours:[{id:0,count:Math.floor(Math.random()*9),date:new Date("2023-07-18")},{id:1,count:Math.floor(Math.random()*9),date:new Date("2023-07-17")},{id:2,count:Math.floor(Math.random()*9),date:new Date("2023-07-16")},{id:3,count:Math.floor(Math.random()*9),date:new Date("2023-07-15")},{id:4,count:Math.floor(Math.random()*9),date:new Date("2023-07-14")},{id:5,count:Math.floor(Math.random()*9),date:new Date("2023-07-13")},{id:6,count:Math.floor(Math.random()*9),date:new Date("2023-07-12")}],activities:[{id:0,hours:Math.floor(Math.random()*9),date:new Date("2023-07-18"),type:"Aratura",workerName:"Mario Rossi"},{id:1,hours:Math.floor(Math.random()*9),date:new Date("2023-07-17"),type:"Raccolta",workerName:"Mario Rossi"},{id:2,hours:Math.floor(Math.random()*9),date:new Date("2023-07-16"),type:"Semina",workerName:"Mario Rossi"},{id:3,hours:Math.floor(Math.random()*9),date:new Date("2023-07-15"),type:"Aratura",workerName:"Mario Rossi"},{id:4,hours:Math.floor(Math.random()*9),date:new Date("2023-07-14"),type:"Raccolta",workerName:"Mario Rossi"},{id:5,hours:Math.floor(Math.random()*9),date:new Date("2023-07-13"),type:"Semina",workerName:"Mario Rossi"},{id:6,hours:Math.floor(Math.random()*9),date:new Date("2023-07-12"),type:"Aratura",workerName:"Mario Rossi"}]}],pe={class:"absolute bottom-0 left-0 w-10/12 z-20 rounded-tr-md bg-bg-100 border-l",style:{height:"46%"}},Me=e("span",{class:"sr-only"},"Chiudi pannello",-1),we=e("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),ge=[Me,we],ve={class:"flex items-start justify-between py-4 mt-9 border-t px-6 border-b",style:{height:"94px"}},ye={class:"flex w-6/12 items-center border-r pr-6"},_e={class:"flex flex-grow flex-col"},De={class:"flex items-center gap-x-3"},be={class:"flex gap-x-3 text-lg leading-7"},xe={class:"font-semibold"},ke={class:"mt-2 text-sm leading-6 text-label"},Re={class:"flex w-6/12"},Ee={class:"flex w-full divide-x divide-border"},qe={class:"text-sm font-medium leading-6 text-label"},Ne={class:"text-3xl font-medium tracking-tight text-text"},Se={key:0,class:"text-sm text-label"},Ae={class:"flex w-full",style:{height:"calc(100% - 130px)"}},$e={class:"flex flex-col h-full w-6/12 overflow-auto thin-scrollbar border-r px-6 relative"},Le={role:"list",class:"space-y-6 py-6"},Be=e("div",{class:"w-px bg-gray-200"},null,-1),Ce=[Be],ze=e("div",{class:"relative flex h-6 w-6 flex-none items-center justify-center bg-bg-100"},[e("div",{class:"h-2 w-2 rounded-full bg-gray-50 ring-1 ring-gray-200"})],-1),Oe={class:"flex-auto rounded-lg p-3 border"},Te={class:"flex justify-between gap-x-4"},Ve={class:"py-0.5 text-xs leading-5 text-gray-500"},Fe={class:"font-medium text-gray-900"},je={class:"flex-none py-0.5 text-xs leading-5 text-gray-500"},Pe={class:"text-sm leading-6 text-gray-500"},He={class:"flex flex-col h-full w-6/12 px-6 border-l overflow-auto thin-scrollbar"},Ue={class:"sticky top-0 z-10 flex w-full justify-end border-b bg-bg-100 pb-3 pt-3 space-x-2"},We={key:0,class:"flex h-full w-full"},Ie={class:"relative flex h-full w-full pb-4 pt-4"},Ge={key:1,class:"w-full pb-6"},Xe=e("th",null,"Ore",-1),Je=e("th",null,"Giorno",-1),Ke=W({__name:"equipmentResumePanel",props:{curEquipment:{}},emits:["close"],setup(c,{emit:B}){const k=Y(),R=d(!0);let D=!1;const r=d(null),A=["Anno","Mese","Settimana"],m=d("Mese"),E=d("chart"),g=d(0);let h=d([]);const v=d([]);let f=[],q=[],p="h",b="",C="Ore";function o(t){t.style.height=0}function F(t){t.style.height=`${c.curEquipment.fuel}%`,t.style.transition="height 1s ease-out"}function X(t){t.style.height=0}function J(t){t.style.height=`${c.curEquipment.signal}%`,t.style.transition="height 1s ease-out"}I(async()=>{c.curEquipment?(P(),j(),L()):D=!0,R.value=!1}),N(()=>k.darkMode,async()=>{L(!0)}),N(()=>c.curEquipment,async()=>{P(),j(),L()});const $=Z(()=>{if(!h.value)return[];const t=[];let n=new Date;h.value.length>0&&(n=new Date(h.value[h.value.length-1].date));let a=0;return m.value==="Anno"?a=365:m.value==="Mese"?a=30:m.value==="Settimana"&&(a=7),n.setDate(new Date().getDate()-a),n.setHours(0,0,0,0),h.value.forEach(u=>{const y=new Date(u.date);y.setHours(0,0,0,0),y.getTime()>n.getTime()&&t.push(u)}),t});function j(){h.value=[];const t=new Date,n=365;t.setDate(new Date().getDate()-n);for(let a=0;a<n;a++){const u=new Date(t);u.setDate(u.getDate()+a);const y={count:Math.floor(Math.random()*(4-20+1)+20),date:u};h.value.push(y)}}function P(){const t=Math.floor(Math.random()*25)+1;v.value=[{name:"Serbatoio",value:c.curEquipment.fuel.toString(),unit:"%"},{name:"Segnale",value:c.curEquipment.signal.toString(),unit:"%"},{name:"Ultima attività",value:t.toString(),unit:"gg fa"}]}N(()=>m.value,async()=>{L()});function L(t=!1){if(console.log($.value),$.value.length===0){D=!0;return}const n=U("blue-400"),a=U("blue-600");q=[],f=[];const u={id:"hour"+k.darkMode.toString(),name:C,itemStyle:{color:n,borderRadius:[8,8,8,8]},emphasis:{itemStyle:{color:a}},type:"bar",data:[]};$.value.forEach(y=>{const Q=new Date(y.date);q.push(new V(Q).format("dd/MM")),u.data.push(Math.round(y.count*100)/100)}),f.push(u),K(),t&&g.value++}function K(){r.value={toolbox:{feature:{dataView:{show:!1},saveAsImage:{show:!1}}},grid:{top:12,right:0,left:5,bottom:0,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"none"}},legend:{show:!1},xAxis:{type:"category",data:q},yAxis:[{type:"value",name:b,position:"left",min:0,max:20,interval:5,axisLabel:{formatter:"{value} "+p}}],series:f,textStyle:{fontFamily:"Work Sans"}}}function H(t,n){return new V(t).format(n)}return(t,n)=>(s(),l("div",pe,[e("button",{type:"button",onClick:n[0]||(n[0]=a=>B("close")),class:"transition-colors-default absolute right-0 top-0 rounded-bl-md rounded-tr-md p-2 text-gray-500 hover:bg-gray-100 focus:outline-none"},ge),e("div",ve,[e("div",ye,[e("div",_e,[e("div",De,[e("h1",be,[e("span",xe,i(t.curEquipment.type),1)])]),e("p",ke,i(t.curEquipment.name),1)])]),e("div",Re,[e("div",Ee,[(s(!0),l(z,null,O(v.value,(a,u)=>(s(),l("div",{key:a.name,class:"w-4/12 px-6 overflow-hidden relative"},[e("p",qe,i(a.name),1),(s(),l("p",{class:"flex items-baseline gap-x-2",key:a.value},[e("span",Ne,i(a.value),1),a.unit?(s(),l("span",Se,i(a.unit),1)):x("",!0)])),a.name==="Serbatoio"?(s(),l("div",{class:M(["flex items-end absolute top-0 bottom-0 right-2 w-2 rounded overflow-hidden",{"bg-green-50":t.curEquipment.fuel>=75,"bg-orange-50":t.curEquipment.fuel>=50&&t.curEquipment.fuel<75,"bg-red-50":t.curEquipment.fuel<50}]),key:t.curEquipment.id},[w(S,{appear:"",onBeforeAppear:o,onAfterAppear:F},{default:_(()=>[e("div",{class:M(["absolute right-0 left-0 bottom-0 w-full",{"bg-green-400":t.curEquipment.fuel>=75,"bg-orange-400":t.curEquipment.fuel>=50&&t.curEquipment.fuel<75,"bg-red-400":t.curEquipment.fuel<50}])},null,2)]),_:1})],2)):x("",!0),a.name==="Segnale"?(s(),l("div",{class:M(["flex items-end absolute top-0 bottom-0 right-2 w-2 rounded overflow-hidden",{"bg-green-50":t.curEquipment.signal>=75,"bg-orange-50":t.curEquipment.signal>=50&&t.curEquipment.signal<75,"bg-red-50":t.curEquipment.signal<50}]),key:t.curEquipment.id},[w(S,{appear:"",onBeforeAppear:X,onAfterAppear:J},{default:_(()=>[e("div",{class:M(["absolute right-0 left-0 bottom-0 w-full",{"bg-green-400":t.curEquipment.signal>=75,"bg-orange-400":t.curEquipment.signal>=50&&t.curEquipment.signal<75,"bg-red-400":t.curEquipment.signal<50}])},null,2)]),_:1})],2)):x("",!0)]))),128))])])]),e("div",Ae,[e("div",$e,[e("ul",Le,[(s(!0),l(z,null,O(t.curEquipment.activities,(a,u)=>(s(),l("li",{key:a.id,class:"relative flex gap-x-4"},[e("div",{class:M([u===t.curEquipment.activities.length-1?"h-6":"-bottom-6","absolute left-0 top-0 flex w-6 justify-center"])},Ce,2),ze,e("div",Oe,[e("div",Te,[e("div",Ve,[e("span",Fe,i(a.workerName),1),ee(" ha eseguito ")]),e("span",je,i(H(a.date,"dd/MM")),1)]),e("p",Pe,i(a.type)+" per "+i(a.hours)+" ore ",1)])]))),128))])]),e("div",He,[e("div",Ue,[w(de,{values:A,onUpdate:n[1]||(n[1]=a=>m.value=a),"cur-value":m.value},null,8,["cur-value"]),w(ue,{onUpdate:n[2]||(n[2]=a=>E.value=a),"cur-value":E.value},null,8,["cur-value"])]),E.value==="chart"?(s(),l("div",We,[e("div",Ie,[R.value?x("",!0):(s(),T(ie,{key:0,options:r.value,loading:R.value,"no-data":te(D),"disable-theme-refresh":!0,rebuild:g.value},null,8,["options","loading","no-data","rebuild"]))])])):(s(),l("div",Ge,[w(ce,{items:$.value,"is-compact":"","full-width":""},{header:_(()=>[Xe,Je]),rows:_(({item:a})=>[e("td",null,i(a.count),1),e("td",null,i(H(a.date,"dd/MM")),1)]),_:1},8,["items"])]))])])]))}});const G=c=>(ne("data-v-8676d12e"),c=c(),se(),c),Qe={class:"relative flex h-full w-full"},Ye={class:"flex flex-col w-96 bg-green-25 rounded-l-lg overflow-auto thin-scrollbar relative"},Ze={class:"flex flex-col w-full pt-4 rounded-t-2xl bg-bg-100 flex-grow"},et={role:"list",class:"divide-y divide-border"},tt=["onClick"],at={class:"flex max justify-between px-4"},ot={class:"flex"},rt={class:"flex flex-col"},nt={class:"text-sm font-semibold leading-6 text-gray-900"},st={class:"mt-1 flex text-xs leading-5 text-gray-500"},lt={class:"flex items-center"},it={class:"hidden sm:flex sm:flex-col sm:items-end"},dt={class:"text-sm leading-6 text-gray-900"},ut={class:"mt-1 text-xs leading-5 text-gray-500"},ct={class:"mt-1 flex items-center gap-x-1.5"},ht=G(()=>e("p",{class:"text-xs leading-5 text-gray-500"},"Serbatoio",-1)),mt={class:"flex flex-col flex-grow relative overflow-hidden"},ft=G(()=>e("div",{class:"h-full w-full bg-green-200 absolute"},null,-1)),pt=W({__name:"index",setup(c){const B=[{name:"Macchinari",id:"equipments",icon:"fa-tractor"},{name:"Appezz.",id:"plots",icon:"fa-map"},{name:"Ndvi",id:"ndvi",icon:"fa-satellite"}],k=d(!1),R=d(he),D=d(fe),r=d(null),A=d(0),m=d(0),E=d(B[0].id),g=d(!1);I(()=>{ae(()=>{k.value=!0})}),N(()=>E.value,()=>{g.value=!1,r.value=null}),N(()=>r.value,()=>{r&&(g.value=!0)});function h(){g.value=!1,r.value=null}function v(p){return p.fuel<=30}function f(p){return p.fuel<=50}function q(p,b){return new V(p).format(b)}return(p,b)=>{const C=oe("bf-tooltip");return s(),l("div",Qe,[e("div",Ye,[e("div",Ze,[w(S,{"enter-active-class":"transition duration-150 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100"},{default:_(()=>[e("ul",et,[(s(!0),l(z,null,O(D.value,o=>(s(),l("li",{class:M(["relative py-3 hover:bg-gray-50 cursor-pointer transition-colors-default",{"!bg-gray-100":r.value&&r.value.id===o.id}]),onClick:F=>{r.value=!r.value||r.value&&r.value.id!==o.id?o:null,A.value++}},[e("div",at,[e("div",ot,[e("div",rt,[e("p",nt,i(o.type),1),e("p",st,i(o.name),1)])]),e("div",lt,[e("div",it,[e("p",dt," Ultima attività "+i(q(o.last_activity,"dd/MM")),1),e("p",ut," Segnale "+i(o.signal+"%"),1),e("div",ct,[re((s(),l("div",{class:M(["flex-none rounded-full p-1",{"bg-green-500/20":!f(o),"bg-orange-500/20":f(o)&&!v(o),"bg-red-500/20":v(o)}])},[e("div",{class:M(["h-1.5 w-1.5 rounded-full",{"bg-green-500":!f(o),"bg-orange-500":f(o)&&!v(o),"bg-red-500":v(o)}])},null,2)],2)),[[C,o.fuel+"%"]]),ht])])])])],10,tt))),256))])]),_:1})])]),e("div",mt,[ft,w(S,{"enter-active-class":"transition duration-300 ease-out delay-500","enter-from-class":"opacity-0","enter-to-class":"opacity-100"},{default:_(()=>[k.value?(s(),T(le,{key:0,"show-ndvi":!1,parcels:R.value,curParcel:null,traps:[],curTrap:null,equipments:D.value,curEquipment:r.value,zoomOnPlot:m.value,zoomOnTrap:0,zoomOnEquipment:A.value,onSelectEquipment:b[0]||(b[0]=o=>r.value=!r.value||r.value&&r.value.id!==o.id?o:null)},null,8,["parcels","equipments","curEquipment","zoomOnPlot","zoomOnEquipment"])):x("",!0)]),_:1}),w(S,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:_(()=>[g.value&&r.value?(s(),T(Ke,{key:0,curEquipment:r.value,onClose:h},null,8,["curEquipment"])):x("",!0)]),_:1})])])}}}),Nt=me(pt,[["__scopeId","data-v-8676d12e"]]);export{Nt as default};
