import{g as U,D as Q,_ as fe,L as ze,t as Ee,a as j}from"./Colors.6bec5346.js";import{o as s,c as _,a as e,d as W,n as T,j as h,m as me,q as Y,v as ye,r as g,e as ee,g as G,b as re,x as I,y as m,A as n,u as k,z as K,B as ve,F as X,T as _e,M as Be,N as Re,C as We}from"./index.4df9b7c0.js";import{_ as Ae,a as ne,b as Ce,S as Pe,c as je,M as ge,g as He,T as Ie,B as Ne,u as Oe,d as Ue,p as Ge,C as Ze,W as qe,V as ce,e as xe,f as we,h as be,i as De,j as Ke,k as le,l as oe,P as Xe,m as de,F as q,n as ue,o as Ye,q as ke,r as Je,s as Qe,t as et}from"./parcelData.ea2349db.js";import{_ as Te}from"./BfButton.3c14cdcd.js";import{r as tt}from"./BellIcon.26053bf2.js";import"./use-outside-click.996d01e2.js";function at(f,y){return s(),_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"})])}function it(f,y){return s(),_("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[e("path",{d:"M3 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM8.5 10a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM15.5 8.5a1.5 1.5 0 100 3 1.5 1.5 0 000-3z"})])}const st={class:"flex flex-grow"},lt={class:"flex space-x-2"},te=W({__name:"WidgetTile",props:{title:null,isMap:{type:Boolean,default:!1},isWeather:{type:Boolean,default:!1},noHeader:{type:Boolean,default:!1}},setup(f){return(y,x)=>(s(),_("div",{class:T(["relative flex h-full flex-col overflow-hidden rounded-xl",{"bg-bg-100":!f.isMap&&!f.isWeather}])},[f.noHeader?Y("",!0):(s(),_("div",{key:0,class:T(["text-info-700 flex h-16 w-full flex-shrink-0 items-center px-6 font-semibold",{"absolute z-10 bg-green-25/70 backdrop-blur-md":f.isMap,"absolute z-10 text-text-opposite":f.isWeather}])},[e("span",st,h(f.title),1),e("div",lt,[me(y.$slots,"actions")])],2)),me(y.$slots,"default")],2))}}),ot={key:0,class:"relative h-full w-full"},nt={key:1,class:"relative h-full w-full px-6 overflow-auto thin-scrollbar"},rt=e("div",{class:"border-t sticky top-0"},null,-1),ct=e("th",null,"Pioggia",-1),dt=e("th",null,"Giorno",-1),$e=W({__name:"rainWidget",setup(f){const y=ye(),x=g(!0),b=!1,l=g(null);let i=null;const z=["Anno","Bimestre","Settimana"],p=g("Bimestre"),$=g("chart"),w=g(0);ee(()=>{i=[];const v=new Date,a=365;v.setDate(new Date().getDate()-a);for(let t=0;t<a;t++){const u=new Date(v);u.setDate(u.getDate()+t);const r={irrigation:Math.floor(Math.random()*(4-20+1)+20),rain:Math.floor(Math.random()*(2-10+1)+10),evotraspiration:Math.floor(Math.random()*(4-20+1)+20),date:u};i.push(r)}S(),x.value=!1});let d=[],D=[],A="mm",H="",E="Pioggia";G(()=>y.darkMode,async()=>{S(!0)}),G(()=>p.value,async()=>{S()});const F=re(()=>{if(!i)return[];const v=[];let a=new Date;i.length>0&&(a=new Date(i[i.length-1].date));let t=0;return p.value==="Anno"?t=365:p.value==="Bimestre"?t=50:p.value==="Settimana"&&(t=7),a.setDate(new Date().getDate()-t),a.setHours(0,0,0,0),i.forEach(u=>{const r=new Date(u.date);r.setHours(0,0,0,0),r.getTime()>a.getTime()&&v.push(u)}),v});function S(v=!1){if(F.value.length===0)return;const a=U("blue-400"),t=U("blue-600");D=[],d=[];const u={id:"rain"+y.darkMode.toString(),name:E,itemStyle:{color:a,borderRadius:[8,8,8,8]},emphasis:{itemStyle:{color:t}},type:"bar",data:[]};F.value.forEach(r=>{const N=new Date(r.date);D.push(new Q(N).format("dd/MM")),u.data.push(Math.round(r.irrigation*100)/100)}),d.push(u),P(),v&&w.value++}function P(){l.value={toolbox:{feature:{dataView:{show:!1},saveAsImage:{show:!1}}},grid:{top:12,right:24,left:24,bottom:20,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"none"}},legend:{show:!1},xAxis:{type:"category",data:D},yAxis:[{type:"value",name:H,position:"left",min:0,max:20,interval:5,axisLabel:{formatter:"{value} "+A}}],series:d,textStyle:{fontFamily:"Work Sans"}}}return(v,a)=>(s(),I(te,{title:"Pioggia"},{actions:m(()=>[n(Ae,{values:z,onUpdate:a[0]||(a[0]=t=>p.value=t),"cur-value":p.value},null,8,["cur-value"]),n(ne,{onUpdate:a[1]||(a[1]=t=>$.value=t),"cur-value":$.value},null,8,["cur-value"])]),default:m(()=>[$.value==="chart"?(s(),_("div",ot,[x.value?Y("",!0):(s(),I(fe,{key:0,options:l.value,loading:x.value,"no-data":b,"disable-theme-refresh":!0,rebuild:w.value},null,8,["options","loading","rebuild"]))])):(s(),_("div",nt,[rt,n(Ce,{items:k(F),"is-compact":"","full-width":""},{header:m(()=>[ct,dt]),rows:m(({item:t})=>[e("td",null,h(t.rain)+"mm",1),e("td",null,h(new k(Q)(t.date).format("dd/MM")),1)]),_:1},8,["items"])]))]),_:1}))}}),ut={key:0,class:"relative h-full w-full"},_t={key:1,class:"relative h-full w-full px-6 overflow-auto thin-scrollbar"},ft=e("div",{class:"border-t sticky top-0"},null,-1),yt=e("th",null,"Umidit\xE0",-1),vt=e("th",null,"Giorno",-1),Se=W({__name:"humidityWidget",setup(f){const y=ye(),x=g(!0),b=!1,l=g(null);let i=null;const z=["Anno","Bimestre","Settimana"],p=g("Bimestre"),$=g("chart"),w=g(0);ee(()=>{i=[];const v=new Date,a=365;v.setDate(new Date().getDate()-a);for(let t=0;t<a;t++){const u=new Date(v);u.setDate(u.getDate()+t);const r={humidity:Math.floor(Math.random()*(4-80+1)+80),date:u};i.push(r)}S(),x.value=!1});let d=[],D=[],A="%",H="",E="Umidit\xE0";G(()=>y.darkMode,async()=>{S(!0)}),G(()=>p.value,async()=>{S()});const F=re(()=>{if(!i)return[];const v=[];let a=new Date;i.length>0&&(a=new Date(i[i.length-1].date));let t=0;return p.value==="Anno"?t=365:p.value==="Bimestre"?t=50:p.value==="Settimana"&&(t=7),a.setDate(new Date().getDate()-t),a.setHours(0,0,0,0),i.forEach(u=>{const r=new Date(u.date);r.setHours(0,0,0,0),r.getTime()>a.getTime()&&v.push(u)}),v});function S(v=!1){if(F.value.length===0)return;const a=U(y.darkMode?"green-500":"teal-400"),t=U(y.darkMode?"green-400":"teal-300"),u=U(y.darkMode?"green-300":"teal-200"),r=U(y.darkMode?"green-50":"teal-50");D=[],d=[];const N={id:"rain",name:E,smooth:!0,lineStyle:{color:a,width:2},itemStyle:{color:t},symbolSize:6,areaStyle:{opacity:.8,color:new ze(0,0,0,1,[{offset:0,color:u},{offset:1,color:r}])},type:"line",data:[]};F.value.forEach(M=>{const B=new Date(M.date);D.push(new Q(B).format("dd/MM")),N.data.push(Math.round(M.humidity*100)/100)}),d.push(N),P(),v&&w.value++}function P(){l.value={grid:{top:12,right:24,left:24,bottom:20,containLabel:!0},tooltip:{trigger:"axis"},legend:{show:!1},xAxis:{type:"category",data:D},yAxis:[{type:"value",name:H,position:"left",min:0,max:100,interval:25,axisLabel:{formatter:"{value}"+A}}],series:d,textStyle:{fontFamily:"Work Sans"}}}return(v,a)=>(s(),I(te,{title:"Umidit\xE0"},{actions:m(()=>[n(Ae,{values:z,onUpdate:a[0]||(a[0]=t=>p.value=t),"cur-value":p.value},null,8,["cur-value"]),n(ne,{onUpdate:a[1]||(a[1]=t=>$.value=t),"cur-value":$.value},null,8,["cur-value"])]),default:m(()=>[$.value==="chart"?(s(),_("div",ut,[x.value?Y("",!0):(s(),I(fe,{key:0,options:l.value,loading:x.value,"no-data":b,"disable-theme-refresh":!0,rebuild:w.value},null,8,["options","loading","rebuild"]))])):(s(),_("div",_t,[ft,n(Ce,{items:k(F),"is-compact":"","full-width":""},{header:m(()=>[yt,vt]),rows:m(({item:t})=>[e("td",null,h(t.humidity)+"%",1),e("td",null,h(new k(Q)(t.date).format("dd/MM")),1)]),_:1},8,["items"])]))]),_:1}))}}),pt={class:"thin-scrollbar relative h-full w-full overflow-auto px-6"},ht=e("div",{class:"text-info-700 flex h-16 w-full flex-shrink-0 items-center font-semibold"},[e("span",{class:"flex flex-grow"}," Allarmi ")],-1),mt=e("div",{class:"font-serif text-2xl"}," Hai avuto 25% allarmi in pi\xF9 questa settimana rispetto al solito ",-1),gt={class:"-mx-2 flex flex-wrap justify-end pb-3 pt-3"},xt={class:"flex w-full flex-col justify-between px-4 py-2"},wt={class:"text-3xl font-light"},bt={class:"pl-1 text-2xl"},Dt={class:"text-sm font-light"},Me=W({__name:"alarmsWidget",setup(f){const y=[{id:"strong_rain",type:"warning",text:"pioggia intensa",value:54,measure:"mm",date:"Dom 9"},{id:"rain",type:"info",text:"pioggia debole",value:28,measure:"mm",date:"Sab 8"},{id:"stron_wind",type:"warning",text:"vento forte",value:72,measure:"km/h",date:"Mer 5"},{id:"wind",type:"info",text:"vento debole",value:45,measure:"km/h",date:"Lun 3"}];return(x,b)=>(s(),I(te,{"no-header":""},{default:m(()=>[e("div",pt,[ht,mt,e("div",gt,[(s(),_(X,null,K(y,(l,i)=>e("div",{key:i,class:"flex w-full md:w-6/12 px-2 py-2"},[e("div",{class:T(["flex h-full w-full items-stretch rounded rounded-r-md",{"bg-red-50":l.type==="danger","bg-orange-50":l.type==="warning","bg-blue-50":l.type==="info"}])},[e("div",{class:T(["w-1 rounded-md",{"bg-red-500":l.type==="danger","bg-orange-500":l.type==="warning","bg-blue-500":l.type==="info"}])},null,2),e("div",xt,[e("p",{class:T(["pb-1 text-sm font-light uppercase tracking-wider",{"text-red-700":l.type==="danger","text-orange-800":l.type==="warning","text-blue-700":l.type==="info"}])},h(l.text),3),e("div",{class:T(["flex w-full items-baseline justify-between",{"text-red-800":l.type==="danger","text-orange-900":l.type==="warning","text-blue-800":l.type==="info"}])},[e("p",wt,[ve(h(l.value),1),e("span",bt,h(l.measure),1)]),e("p",Dt,h(l.date),1)],2)])],2)])),64))])])]),_:1}))}}),kt=[{id:"plow",activity_type_description:"Aratura",activity_type_color:"red",activity_type_icon:"fa-tractor"},{id:"seed",activity_type_description:"Semina",activity_type_color:"green",activity_type_icon:"fa-seedling"},{id:"irrigation",activity_type_description:"Irrigazione",activity_type_color:"blue",activity_type_icon:"fa-tint"},{id:"fertilizer",activity_type_description:"Fertilizzazione",activity_type_color:"yellow",activity_type_icon:"fa-flask"},{id:"agrochemical",activity_type_description:"Tratt. agrofarmaci",activity_type_color:"purple",activity_type_icon:"fa-bug"},{id:"harvest",activity_type_description:"Raccolta",activity_type_color:"orange",activity_type_icon:"fa-leaf"},{id:"other",activity_type_description:"Altro",activity_type_color:"gray",activity_type_icon:"fa-question"}],$t=[{id:1,activity_type_id:"plow",activity_date:new Date("2023-03-12"),activity_executed:!0},{id:2,activity_type_id:"plow",activity_date:new Date("2023-03-15"),activity_executed:!0},{id:3,activity_type_id:"plow",activity_date:new Date("2023-03-18"),activity_executed:!0},{id:4,activity_type_id:"seed",activity_date:new Date("2023-03-22"),activity_executed:!0},{id:5,activity_type_id:"fertilizer",activity_date:new Date("2023-03-28"),activity_executed:!0}],St=[{id:1,activity_type_id:"plow",activity_date:new Date("2021-01-01"),activity_executed:!0},{id:1.1,activity_type_id:"plow",activity_date:new Date("2023-01-01"),activity_executed:!0},{id:1.2,activity_type_id:"plow",activity_date:new Date("2023-01-01"),activity_executed:!0},{id:2,activity_type_id:"seed",activity_date:new Date("2023-04-18"),activity_executed:!0},{id:3,activity_type_id:"fertilizer",activity_date:new Date("2023-04-16"),activity_executed:!0},{id:3.1,activity_type_id:"fertilizer",activity_date:new Date("2023-03-16"),activity_executed:!0},{id:3.2,activity_type_id:"fertilizer",activity_date:new Date("2023-02-16"),activity_executed:!0},{id:4,activity_type_id:"irrigation",activity_date:new Date("2023-02-12"),activity_executed:!0},{id:5,activity_type_id:"irrigation",activity_date:new Date("2023-03-20"),activity_executed:!0},{id:5,activity_type_id:"irrigation",activity_date:new Date("2023-04-02"),activity_executed:!0},{id:19,activity_type_id:"harvest",activity_date:new Date("2023-04-8"),activity_executed:!0},{id:20,activity_type_id:"harvest",activity_date:new Date("2023-04-10"),activity_executed:!0},{id:21,activity_type_id:"plow",activity_date:new Date("2023-03-10"),activity_executed:!0},{id:22,activity_type_id:"plow",activity_date:new Date("2023-02-22"),activity_executed:!0},{id:23,activity_type_id:"plow",activity_date:new Date("2023-02-27"),activity_executed:!0}],Mt=[{id:0,activity_type_id:"plow",activity_date:new Date("2023-01-01"),activity_executed:!0},{id:.1,activity_type_id:"plow",activity_date:new Date("2023-01-01"),activity_executed:!0},{id:1,activity_type_id:"plow",activity_date:new Date("2023-01-01"),activity_executed:!0},{id:2,activity_type_id:"seed",activity_date:new Date("2023-01-02"),activity_executed:!0},{id:3,activity_type_id:"irrigation",activity_date:new Date("2023-01-03"),activity_executed:!0},{id:3.1,activity_type_id:"irrigation",activity_date:new Date("2023-01-03"),activity_executed:!0},{id:3.2,activity_type_id:"irrigation",activity_date:new Date("2023-01-03"),activity_executed:!0},{id:3.3,activity_type_id:"irrigation",activity_date:new Date("2023-01-03"),activity_executed:!0},{id:3.4,activity_type_id:"irrigation",activity_date:new Date("2023-01-03"),activity_executed:!0},{id:4,activity_type_id:"fertilizer",activity_date:new Date("2023-01-04"),activity_executed:!0},{id:4.1,activity_type_id:"fertilizer",activity_date:new Date("2023-01-04"),activity_executed:!0},{id:4.2,activity_type_id:"fertilizer",activity_date:new Date("2023-01-04"),activity_executed:!0},{id:5,activity_type_id:"agrochemical",activity_date:new Date("2023-01-05"),activity_executed:!0},{id:5.1,activity_type_id:"agrochemical",activity_date:new Date("2023-01-05"),activity_executed:!0},{id:5.2,activity_type_id:"agrochemical",activity_date:new Date("2023-01-05"),activity_executed:!0},{id:5.3,activity_type_id:"agrochemical",activity_date:new Date("2023-01-05"),activity_executed:!0},{id:5.4,activity_type_id:"agrochemical",activity_date:new Date("2023-01-05"),activity_executed:!0},{id:5.5,activity_type_id:"agrochemical",activity_date:new Date("2023-01-05"),activity_executed:!0},{id:6,activity_type_id:"harvest",activity_date:new Date("2023-01-06"),activity_executed:!0}],Lt=[{id:0,parcel_id:1,parcel_code:1,activities:$t},{id:1,parcel_id:2,parcel_code:2,activities:St},{id:2,parcel_id:3,parcel_code:3,activities:Mt}],At={class:"absolute bottom-0 left-0 right-6 z-20 h-3/5 rounded-tr-md bg-bg-100"},Ct=e("span",{class:"sr-only"},"Chiudi pannello",-1),Tt=e("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Ft=[Ct,Tt],Vt={class:"flex w-full divide-x divide-border border-b",style:{height:"92px"}},zt={class:"flex-grow px-6 py-4 overflow-hidden"},Et={class:"text-sm font-medium leading-6 text-label"},Bt={class:"text-3xl font-medium tracking-tight text-text"},Rt={key:0,class:"text-sm text-label"},Wt={class:"flex w-full flex-col",style:{height:"calc(100% - 92px)"}},Pt={class:"flex h-full w-full"},jt={key:0,class:"flex h-full w-full"},Ht={class:"relative flex h-full w-full pb-4 pl-3 pr-3 pt-4"},It={class:"absolute z-10 flex h-16 w-12 flex-col items-center justify-center",style:{left:"calc(50% - 1.5rem)",top:"calc(50% - 2rem)"}},Nt=e("span",{class:"text-sm font-medium text-label"},"Totali",-1),Ot={class:"text-3xl font-medium tracking-tight text-text"},Ut={class:"thin-scrollbar relative flex h-full w-full flex-col space-y-3 overflow-auto pb-4 pl-8 pr-6"},Gt={class:"sticky top-0 z-10 flex w-full justify-end border-b bg-bg-100 pb-3 pt-3"},Zt={class:"flex w-full flex-col"},qt={class:"flex w-full items-center"},Kt={class:"text-sm font-medium text-label"},Xt={class:"text-3xl font-medium tracking-tight text-text"},Yt={key:1,class:"thin-scrollbar h-full w-full overflow-auto px-6 pb-6"},Jt={class:"sticky top-0 z-10 flex w-full justify-end border-b bg-bg-100 py-3"},Qt={role:"list",class:"flex w-full flex-col pt-6"},ea={class:"flex items-center gap-x-4 px-4 py-4"},ta={class:"flex h-12 w-12 items-center justify-center rounded-md bg-green-400/5 text-green-400"},aa={class:"flex flex-col"},ia={class:"text-sm font-medium leading-6 text-gray-900"},sa={class:"text-sm font-medium leading-6 text-label"},la=e("span",{class:"sr-only"},"Apri opzioni",-1),oa=W({__name:"activityResumePanel",props:{activityParcel:null,activityResume:null},emits:["close"],setup(f,{emit:y}){const x=ye(),b=g(!0);let l=!1;const i=g(null),z=g("Settimana"),p=g("chart"),$=g(0),w=kt,d=g([]),D=Ee.color;let A=[],H=[],E=[];ee(()=>{f.activityResume&&f.activityResume.activities.length>0?(S(),F()):l=!0,b.value=!1}),G(()=>x.darkMode,async()=>{S(!0)}),G(()=>z.value,async()=>{S()}),G(()=>f.activityResume,async()=>{S(),F()});function F(){const v=Math.floor(Math.random()*45)+5,a=Math.floor(Math.random()*55)+25,t=(Math.floor(Math.random()*18)+2)/10;d.value=[{name:"Ore totali",value:v.toString()},{name:"Media",value:a.toString(),unit:"min"},{name:"Irrigazioni",value:t.toString(),unit:"hl"}]}function S(v=!1){f.activityResume.activities.sort((M,B)=>new Date(B.activity_date).getTime()-new Date(M.activity_date).getTime());const a=f.activityResume.activities,t=U("color-bg-100");H=[],A=[],E=[];const u={id:"activities",name:"Attivit\xE0",radius:["92%","100%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:t,borderWidth:4},label:{show:!1,position:"center"},emphasis:{label:{show:!1,fontSize:40,fontWeight:"bold"}},labelLine:{show:!1},type:"pie",data:[]};let r=new Date;a.length>0&&(r=new Date(a[a.length-1].activity_date));let N=365;r.setDate(new Date().getDate()-N),r.setHours(0,0,0,0),a.forEach(M=>{E.findIndex(B=>B.type_id===M.activity_type_id)===-1&&E.push({type_id:M.activity_type_id,type_description:w.find(B=>B.id===M.activity_type_id)?.activity_type_description||"",colorIndex:0,count:0})}),E.forEach((M,B)=>{let ae=0;a.forEach(ie=>{const se=new Date(ie.activity_date);se.setHours(0,0,0,0),ie.activity_type_id===M.type_id&&se.getTime()>r.getTime()&&ae++}),M.count=ae,M.colorIndex=B,H.push(M.type_description),u.data.push({value:M.count,name:M.type_description})}),A.push(u),P(),v&&$.value++}function P(){i.value={grid:{top:12,right:24,left:24,bottom:20,containLabel:!0},tooltip:{trigger:"none"},legend:{show:!1,selectedMode:!1},series:A,textStyle:{fontFamily:"Work Sans"}}}return(v,a)=>(s(),_("div",At,[e("button",{type:"button",onClick:a[0]||(a[0]=t=>y("close")),class:"transition-colors-default absolute right-0 top-0 rounded-bl-md rounded-tr-md p-2 text-gray-500 hover:bg-gray-100 focus:outline-none"},Ft),e("div",Vt,[(s(!0),_(X,null,K(d.value,t=>(s(),_("div",zt,[e("p",Et,h(t.name),1),n(_e,{"enter-active-class":"transition duration-150 ease-out","enter-from-class":"translate-y-0 opacity-0","enter-to-class":"translate-y-0 opacity-100"},{default:m(()=>[(s(),_("p",{class:"flex items-baseline gap-x-2",key:t.value},[e("span",Bt,h(t.value),1),t.unit?(s(),_("span",Rt,h(t.unit),1)):Y("",!0)]))]),_:2},1024)]))),256))]),e("div",Wt,[e("div",Pt,[p.value==="chart"?(s(),_("div",jt,[e("div",Ht,[e("div",It,[Nt,e("span",Ot,h(f.activityResume.activities.length),1)]),b.value?Y("",!0):(s(),I(fe,{key:0,options:i.value,loading:b.value,"no-data":k(l),"disable-theme-refresh":!0,rebuild:$.value},null,8,["options","loading","no-data","rebuild"]))]),e("div",Ut,[e("div",Gt,[n(ne,{onUpdate:a[1]||(a[1]=t=>p.value=t),"cur-value":p.value},null,8,["cur-value"])]),(s(!0),_(X,null,K(k(E).sort((t,u)=>u.count-t.count),t=>(s(),_("div",Zt,[e("div",qt,[e("div",{class:"mr-2 h-3 w-3 rounded-sm",style:Be("background: "+k(D)[t.colorIndex])},null,4),e("span",Kt,h(t.type_description),1)]),e("div",null,[e("span",Xt,h(t.count),1)])]))),256))])])):(s(),_("div",Yt,[e("div",Jt,[n(ne,{onUpdate:a[2]||(a[2]=t=>p.value=t),"cur-value":p.value},null,8,["cur-value"])]),e("ul",Qt,[(s(!0),_(X,null,K(f.activityResume.activities,(t,u)=>(s(),_("li",{key:t.id,class:T(["border-x border-t",{"rounded-t-xl":u===0,"rounded-b-xl border-b":u===f.activityResume.activities.length-1}])},[e("div",ea,[e("div",ta,[e("i",{class:T(["fas",k(w).find(r=>r.id===t.activity_type_id).activity_type_icon])},null,2)]),e("div",aa,[e("div",ia,h(k(w).find(r=>r.id===t.activity_type_id).activity_type_description),1),e("div",sa,h(new k(Q)(t.activity_date).format("dd/MM")),1)]),n(k(He),{as:"div",class:"relative ml-auto"},{default:m(()=>[n(k(Pe),{class:"-m-2.5 block p-2.5 text-gray-400 hover:text-gray-500"},{default:m(()=>[la,n(k(it),{class:"h-5 w-5","aria-hidden":"true"})]),_:1}),n(_e,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:m(()=>[n(k(je),{class:"absolute right-0 z-10 mt-0.5 w-40 origin-top-right overflow-hidden rounded-md bg-bg-100 shadow-lg ring-1 ring-gray-900/5 focus:outline-none"},{default:m(()=>[n(k(ge),null,{default:m(({active:r})=>[e("a",{href:"#",class:T([r?"bg-gray-50":"","block px-3 py-2 text-sm leading-6 text-gray-900"])},"Visualizza",2)]),_:1}),n(k(ge),null,{default:m(({active:r})=>[e("a",{href:"#",class:T([r?"bg-gray-50":"","block px-3 py-2 text-sm leading-6 text-gray-900"])},"Modifica",2)]),_:1})]),_:1})]),_:1})]),_:1})])],2))),128))])]))])])]))}}),na=W({__name:"ActivityMapViewer",setup(f){const y="Aerial",x="Ak2gN0iZ3d02J-xwYSYgRp8oHFZCOneWeg_Hj7C2ZntIKTXCGc0HXVQ8GHkuxp17",b=new Ie({visible:!0,preload:1/0,source:new Ne({key:x,imagerySet:y})}),l=Oe(),{map:i,mapRef:z,padding:p}=Ue(),$=g(Ge),w=g(Lt);let d=null,D=null;const A=new Ze;let H=null;const E=new qe,F=g(!1),S=g(null),P=g(null);ee(async()=>{z.value&&(i.setTarget(z.value),z.value.addEventListener("mouseleave",a),await new Promise(c=>setTimeout(c,500))),r(),i.getLayers().clear(),await v(),N(),M()});async function v(){i.addLayer(b)}Re(()=>{r()});function a(){l.emit("hover:map",[])}function t(c){if(c.type==="pointermove"){const o=i.getFeaturesAtPixel(c.pixel);if(o&&o.length>=1){const C=o[0]?.values_?.features[0]?.values_?.type;if(C&&C==="activity"){const L=o[0].get("features");if(Array.isArray(L)&&L.length>0){const O=L.map(V=>V.get("ref"));l.emit("hover:map",O)}else l.emit("hover:map",[o[0].get("ref")]);i.getTargetElement().style.cursor="pointer"}}else l.emit("hover:map",[]),i.getTargetElement().style.cursor="default";return!0}return!1}function u(c){const o=et();return c.forEach(C=>{const L=C.getGeometry();L&&Qe(o,L.getExtent())}),o}function r(){i.getLayers().getArray().filter(o=>o instanceof ce).forEach(o=>{i.removeLayer(o)}),A.getLength()&&A.clear(),d&&(i.removeInteraction(d),d.dispose(),d=null),D&&(i.removeInteraction(D),D.dispose(),D=null)}function N(){const c=[];$.value.forEach(L=>{const O=E.readFeature(L.world_geom);O.setProperties({ref:L.parcel_id,type:"parcel",parcel_id:L.parcel_id}),A.push(O),c.push(O)}),H=new xe({features:c});const o=new we({distance:0,source:H,geometryFunction:he}),C=new ce({source:o,style:B,properties:{name:"parcelLayer",ref:be.VECTOR,id:"parcel"},renderBuffer:500});i.addLayer(C),C.setZIndex(900)}function M(){const c=[];$.value.forEach(V=>{const R=w.value.find(J=>J.parcel_id===V.parcel_id),Z=R?R.activities.length:0;if(R&&Z>0){const J=E.readFeature(V.world_geom);J.setProperties({ref:"activity_"+V.parcel_id,type:"activity",parcel_activity_id:R.id,parcel_id:R.parcel_id,activity_count:Z}),A.push(J),c.push(J)}});const o=new xe({features:c}),C=new we({distance:0,source:o,geometryFunction:he}),L=new ce({source:C,style:ae,properties:{name:"interactionLayer",ref:be.VECTOR,id:"activity"},renderBuffer:500});d=new De({style:se,condition(V){return Ke(V)},layers:function(V){return V.get("name")==="interactionLayer"}}),i.addInteraction(d),d.on("select",V=>{const R=V.target.getFeatures().getArray()[0].getProperties().features;if(R.length>1){const Z=u(R);pe(Z)}else{const Z=R[0].get("parcel_id");Fe(Z)}}),D=new De({style:ie,condition:t,layers:function(V){return V.get("name")==="interactionLayer"}}),i.addInteraction(D),i.addLayer(L),L.setZIndex(910);const O=u(A.getArray());pe(O)}const B=c=>{if(c.get("features")!==void 0){const L=c.get("features")[0].getGeometry().getCoordinates();return new le({stroke:new oe({color:j("lime-200",1),width:2}),geometry:new Xe(L)})}},ae=c=>{const o=c.get("features");if(o!==void 0)return new le({image:new de({radius:16,fill:new q({color:j("green-300",1)}),stroke:new oe({color:j("green-300",.4),width:14})}),text:new ue({text:o[0].values_.activity_count.toString(),fill:new q({color:j("green-800",1)}),font:"bold 13px Work Sans"})})},ie=c=>{const o=c.get("features");if(o!==void 0)return new le({image:new de({radius:16,fill:new q({color:j("green-200",1)}),stroke:new oe({color:j("green-200",.4),width:14})}),text:new ue({text:o[0].values_.activity_count.toString(),fill:new q({color:j("green-800",1)}),font:"bold 13px Work Sans"})})},se=c=>{const o=c.get("features");if(o!==void 0)return new le({image:new de({radius:16,fill:new q({color:j("green-600",1)}),stroke:new oe({color:j("green-600",.4),width:14})}),text:new ue({text:o[0].values_.activity_count.toString(),fill:new q({color:j("green-50",1)}),font:"bold 13px Work Sans"})})};function pe(c){i.getView().fit(c,{padding:[50,50,50,50],easing:Ye,duration:1e3})}function he(c){const o=c.getGeometry();return o?new ke(Je(o.getExtent())):new ke([0])}function Fe(c){const o=w.value.find(C=>C.parcel_id===c);if(o){const C=$.value.find(L=>L.parcel_id===c);C&&(S.value=o,P.value=C,F.value=!0)}}function Ve(){F.value=!1,S.value=null,P.value=null,d&&d.getFeatures().clear()}return(c,o)=>(s(),_("div",{ref_key:"mapRef",ref:z,class:"relative h-full w-full"},[n(_e,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:m(()=>[F.value&&S.value&&P.value?(s(),I(oa,{key:0,activityResume:S.value,activityParcel:P.value,onClose:Ve},null,8,["activityResume","activityParcel"])):Y("",!0)]),_:1})],512))}}),ra={class:"relative h-full w-full"},ca=W({__name:"activityMapWidget",setup(f){return(y,x)=>(s(),I(te,{title:"Resoconto attivit\xE0","is-map":""},{default:m(()=>[e("div",ra,[n(na)])]),_:1}))}});const da=e("div",{class:"text-info-700 flex pt-5 pb-3 w-full flex-shrink-0 items-center font-semibold"},[e("span",{class:"flex flex-grow text-text-opposite"}," Meteo ")],-1),ua={class:"flex w-full flex-col items-center justify-center pt-2"},_a={class:"flex pb-6"},fa={class:"mr-5 border-r-2 border-bg-100 border-opacity-10 pr-4 text-text-opposite"},ya={class:"text-7xl font-extralight"},va={class:"mb-3 flex flex-col md:flex-row w-full rounded-lg bg-bg-100/10 md:py-2 text-sm text-text-opposite backdrop-blur-lg"},pa={class:"font-light uppercase tracking-wider"},ha={class:"text-2xl font-light"},ma={class:"flex w-full rounded-lg bg-bg-100/10 py-2 text-sm text-text-opposite backdrop-blur-lg"},ga={class:"w-full pb-2 text-center text-xs font-light uppercase tracking-wider"},xa={class:"w-full pb-1 text-center"},wa={class:"w-full pl-1 text-center"},Le=W({__name:"weatherWidget",setup(f){const y={id:"sunny",temp:"27\xB0",icon:"fa-sun-bright",theme:"weather-widget-sun"},x={id:"rainy",temp:"14\xB0",icon:"fa-cloud-showers",theme:"weather-widget-rain"},b=g(x),l=[{title:"Precipitazioni",value:"38 mm"},{title:"Vento",value:"12 km/h"},{title:"Temperature",value:"5\xB0 - 16\xB0"}],i=g([]);ee(()=>{const p=new Date,$=["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],w=["fa-cloud-showers","fa-cloud-bolt","fa-cloud-fog","fa-sun-bright","fa-sun-bright"];for(let d=1;d<=5;d++){const D=new Date(p);D.setDate(D.getDate()+d);const A=Math.floor(Math.random()*15)+10;i.value.push({day:$[D.getDay()],icon:w[d-1],temp:A+"\xB0"})}});function z(){b.value.id===x.id?b.value=y:b.value=x}return(p,$)=>(s(),I(te,{"is-weather":"","no-header":""},{default:m(()=>[e("div",{class:T(["via-teal-500a via-20%a thin-scrollbar-alpha relative h-full w-full overflow-auto bg-gradient-to-br from-green-500 from-0% to-blue-500 to-30% px-6 pb-4",b.value.theme])},[da,e("div",ua,[e("div",_a,[e("div",fa,[e("span",ya,h(b.value.temp),1)]),e("div",{class:"transition-colors-default relative inline-flex cursor-pointer text-bg-100/30 hover:text-bg-100/40",onClick:z},[e("i",{class:T(["fa-solid relative z-10 text-7xl",b.value.icon])},null,2)])]),e("div",va,[(s(),_(X,null,K(l,(w,d)=>e("div",{class:T(["flex flex-grow md:flex-col border-bg-100 border-opacity-10 px-4 py-2 md:py-0 justify-between md:justify-normal items-center md:items-start",d<l.length-1?"border-b md:border-b-0 md:border-r":""])},[e("span",pa,h(w.title),1),e("span",ha,h(w.value),1)],2)),64))]),e("div",ma,[(s(!0),_(X,null,K(i.value,(w,d)=>(s(),_("div",{class:T(["flex flex-grow flex-col border-bg-100 border-opacity-10 px-4",d<i.value.length-1?"border-r":""])},[e("span",ga,h(w.day),1),e("span",xa,[e("i",{class:T(["fa-solid relative z-10 text-xl text-bg-100/30",w.icon])},null,2)]),e("span",wa,h(w.temp),1)],2))),256))])])],2)]),_:1}))}}),ba={class:"relative h-full w-full flex justify-between px-4 items-center bg-gradient-to-br from-lime-500/20 dark:from-blue-500/20 from-0% to-green-500/10 dark:to-green-500/20 to-50%"},Da={class:"flex items-center"},ka={class:"text-green-400 mr-3"},$a=e("span",{class:"font-medium text-sm text-green-800"},"5 nuovi messaggi",-1),Sa={class:"flex flex-col items-center justify-end"},Ma=e("i",{class:"fal fa-arrow-right"},null,-1),La=W({__name:"notificationActionPanel",setup(f){return re(()=>7/10*100),(b,l)=>(s(),_("div",ba,[e("div",Da,[e("span",ka,[n(k(at),{class:"w-6 h-6"})]),$a]),e("div",Sa,[n(Te,{"is-success":""},{icon:m(()=>[Ma]),default:m(()=>[ve("Leggi")]),_:1})])]))}}),Aa={class:"relative h-full w-full flex justify-between px-4 items-center bg-gradient-to-br from-yellow-500/10 dark:from-yellow-500/20 from-0% to-red-500/10 dark:to-red-500/20 to-50%"},Ca={class:"flex items-center"},Ta={class:"text-red-400 mr-3"},Fa=e("span",{class:"font-medium text-sm text-red-800"},"3 nuovi allarmi",-1),Va={class:"flex flex-col items-center justify-end"},za=e("i",{class:"fal fa-arrow-right"},null,-1),Ea=W({__name:"alarmActionPanel",setup(f){return re(()=>7/10*100),(b,l)=>(s(),_("div",Aa,[e("div",Ca,[e("span",Ta,[n(k(tt),{class:"w-6 h-6"})]),Fa]),e("div",Va,[n(Te,{"is-danger":""},{icon:m(()=>[za]),default:m(()=>[ve("Verifica")]),_:1})])]))}}),Ba={class:"flex h-full w-full flex-col items-start overflow-x-hidden px-2 sm:px-4 md:pt-6 lg:px-8 lg:pt-10"},Ra={class:"hidden w-full justify-between md:flex",style:{height:"72px"}},Wa={class:"flex flex-grow flex-col border-l-4 border-green-500 pl-4"},Pa={class:"font-serif text-4xl text-green-800"},ja=e("span",{class:"pt-2 text-base text-green-800"},"Hai 5 messaggi da leggere e 3 allarmi da verificare",-1),Ha={class:"flex items-center space-x-3 h-full"},Ia={class:"w-96 h-full"},Na={class:"rounded-xl w-full h-full overflow-hidden"},Oa={class:"w-96 h-full"},Ua={class:"rounded-xl w-full h-full overflow-hidden"},Ga={class:"-mx-3 flex flex-wrap pb-4 pt-3 lg:flex-grow",style:{height:"calc(100% - 72px)"}},Za={class:"flex h-96 w-full flex-wrap md:h-full md:w-6/12 2xl:w-4/12"},qa={class:"hidden h-96 w-full px-3 py-3 md:block md:h-full"},Ka={class:"block w-full px-3 py-3 md:hidden"},Xa={class:"block w-full px-3 py-3 md:hidden"},Ya={class:"block h-96 w-full px-3 py-3 md:h-1/2 2xl:hidden"},Ja={class:"block h-96 w-full px-3 py-3 md:hidden"},Qa={class:"hidden h-full w-6/12 flex-wrap md:flex 2xl:w-8/12"},ei={class:"w-full px-3 py-3 lg:h-1/2 2xl:w-6/12"},ti={class:"w-full px-3 py-3 lg:h-1/2 2xl:w-6/12"},ai={class:"hidden w-full px-3 py-3 md:h-96 lg:h-1/2 2xl:block 2xl:w-6/12"},ii={class:"w-full px-3 py-3 md:h-96 lg:h-1/2 2xl:w-6/12"},di=W({__name:"index",setup(f){const y=We();return(x,b)=>(s(),_("div",Ba,[e("div",Ra,[e("div",Wa,[e("span",Pa,"Buongiorno "+h(k(y).name),1),ja]),e("div",Ha,[e("div",Ia,[e("div",Na,[n(Ea)])]),e("div",Oa,[e("div",Ua,[n(La)])])])]),e("div",Ga,[e("div",Za,[e("div",qa,[n(ca)]),e("div",Ka,[n(Le)]),e("div",Xa,[n(Me)]),e("div",Ya,[n($e)]),e("div",Ja,[n(Se)])]),e("div",Qa,[e("div",ei,[n(Le)]),e("div",ti,[n(Me)]),e("div",ai,[n($e)]),e("div",ii,[n(Se)])])])]))}});export{di as default};
